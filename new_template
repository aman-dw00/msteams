{
  "$schema": "http://adaptivecards.io/schemas/adaptive-card.json",
  "type": "AdaptiveCard",
  "version": "1.4",
  "body": [
    {
      "type": "TextBlock",
      "text": "${title}",
      "weight": "Bolder",
      "size": "Large",
      "color": "${if(contains(title, 'FIRING'), 'attention', if(contains(title, 'RESOLVED'), 'good', 'default'))}",
      "wrap": true
    },
    {
      "type": "TextBlock",
      "text": "**Alerts Summary**",
      "weight": "Bolder",
      "size": "Medium",
      "spacing": "Medium",
      "separator": true
    },
    {
      "type": "TextBlock",
      "text": "${replace(replace(replace(text, '\\nLabels:', '\\n\\n* **Labels:**'), '\\nAnnotations:', '\\n\\n* **Annotations:**'), '\\nSource:', '\\n\\n* **Source:**')}",
      "wrap": true,
      "spacing": "Medium"
    },
    {
      "type": "TextBlock",
      "text": "**${count(split(text, 'Source:')) - 1} active alerts** found",
      "color": "attention",
      "spacing": "Medium"
    }
  ],
  "actions": [
    {
      "type": "Action.OpenUrl",
      "title": "Open Primary Alert",
      "url": "${if(greater(count(split(text, 'Source:')), 1, trim(split(text, 'Source:')[1]), 'https://grafana.example.com')}"
    },
    {
      "type": "Action.OpenUrl",
      "title": "Open Grafana Dashboard",
      "url": "https://grafana.example.com/dashboards"
    }
  ]
}
