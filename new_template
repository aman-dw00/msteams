{
  "$schema": "http://adaptivecards.io/schemas/adaptive-card.json",
  "type": "AdaptiveCard",
  "version": "1.4",
  "body": [
    {
      "type": "TextBlock",
      "text": "@{triggerBody()?['title']}",
      "weight": "Bolder",
      "size": "Large",
      "color": "@{if(contains(triggerBody()?['title'], 'FIRING'), 'attention', if(contains(triggerBody()?['title'], 'RESOLVED'), 'good', 'default'))}",
      "wrap": true
    },
    {
      "type": "TextBlock",
      "text": "ðŸš¨ **Alerts Summary**",
      "wrap": true,
      "weight": "Bolder",
      "size": "Medium",
      "spacing": "Medium",
      "separator": true
    },
    {
      "type": "TextBlock",
      "text": "@{replace(replace(replace(triggerBody()?['text'], '\nLabels:', '\n\nðŸ”¹ **Labels:**\n'), '\nAnnotations:', '\n\nðŸ“ **Annotations:**\n'), '\nSource:', '\n\nðŸ”— **Source:** ')}",
      "wrap": true,
      "spacing": "Medium"
    }
  ],
  "actions": [
    {
      "type": "Action.OpenUrl",
      "title": "ðŸ”— View All Alerts",
      "url": "@{first(split(triggerBody()?['text'], 'Source: ')[1]}"
    },
    {
      "type": "Action.ShowCard",
      "title": "ðŸ“Œ Individual Alert Links",
      "card": {
        "type": "AdaptiveCard",
        "body": [
          {
            "type": "TextBlock",
            "text": "Select an alert to view:",
            "weight": "Bolder"
          }
        ],
        "actions": "@{replace(join(apply(split(triggerBody()?['text'], 'Source: '), (x, i) => if(greater(i, 0), createArray({
          'type': 'Action.OpenUrl',
          'title': concat('ðŸ”— Alert ', i),
          'url': x
        }), null), ','), 'null,', '')}"
      }
    }
  ]
}
