{
  "$schema": "http://adaptivecards.io/schemas/adaptive-card.json",
  "type": "AdaptiveCard",
  "version": "1.4",
  "body": [
    {
      "type": "TextBlock",
      "text": "üî• @{triggerBody()?['title']}",
      "wrap": true,
      "weight": "Bolder",
      "size": "Large",
      "color": "attention",
      "horizontalAlignment": "Center"
    },
    {
      "type": "TextBlock",
      "text": "**üìÑ Summary:**\n@{triggerBody()?['title']}",
      "wrap": true,
      "spacing": "Small"
    },
    {
      "type": "TextBlock",
      "text": "**üìä Status:** FIRING",
      "wrap": true,
      "spacing": "Small"
    },
    {
      "type": "TextBlock",
      "text": "**üîç Details:**\n‚Ä¢ alertname = @{split(triggerBody()?['text'], 'alertname = ')[1]?split('\n')[0]}\n‚Ä¢ severity = @{split(triggerBody()?['text'], 'severity = ')[1]?split('\n')[0]}\n‚Ä¢ namespace = @{split(triggerBody()?['text'], 'namespace = ')[1]?split('\n')[0]}\n‚Ä¢ pod = @{split(triggerBody()?['text'], 'pod = ')[1]?split('\n')[0]}\n‚Ä¢ team = @{split(triggerBody()?['text'], 'team = ')[1]?split('\n')[0]}\n‚Ä¢ env = @{split(triggerBody()?['text'], 'channel = ')[1]?split('\n')[0]}",
      "wrap": true,
      "spacing": "Small"
    },
    {
      "type": "TextBlock",
      "text": "**üìù Annotations:**\n‚Ä¢ dashboard: @{triggerBody()?['annotations']?['dashboard_url']}\n‚Ä¢ runbook: @{triggerBody()?['annotations']?['runbook_url']}\n‚Ä¢ description: @{triggerBody()?['annotations']?['description']}",
      "wrap": true,
      "spacing": "Small"
    }
  ],
  "actions": [
    {
      "type": "Action.OpenUrl",
      "title": "üìò Runbook",
      "url": "@{triggerBody()?['annotations']?['runbook_url']}"
    },
    {
      "type": "Action.OpenUrl",
      "title": "üìä Dashboard",
      "url": "@{triggerBody()?['annotations']?['dashboard_url']}"
    },
    {
      "type": "Action.OpenUrl",
      "title": "üîï Silence",
      "url": "@{if(contains(triggerBody()?['text'], 'Source:'), trim(split(triggerBody()?['text'], 'Source:')[1]), 'https://example.com')}"
    }
  ]
}






------------------



{
  "$schema": "http://adaptivecards.io/schemas/adaptive-card.json",
  "type": "AdaptiveCard",
  "version": "1.4",
  "body": [
    {
      "type": "TextBlock",
      "text": "@{triggerBody()?['title']}",
      "weight": "Bolder",
      "size": "Large",
      "color": "@{if(contains(triggerBody()?['title'], 'FIRING'), 'attention', if(contains(triggerBody()?['title'], 'RESOLVED'), 'good', 'default'))}",
      "wrap": true
    },
    {
      "type": "TextBlock",
      "text": "üö® **Alerts Summary**",
      "wrap": true,
      "weight": "Bolder",
      "size": "Medium",
      "spacing": "Medium",
      "separator": true
    },
    {
      "type": "TextBlock",
      "text": "@{replace(replace(replace(triggerBody()?['text'], '\nLabels:', '\n\nüîπ **Labels:**\n'), '\nAnnotations:', '\n\nüìù **Annotations:**\n'), '\nSource:', '\n\nüîó **Source:** ')}",
      "wrap": true,
      "spacing": "Medium"
    }
  ],
  "actions": [
    {
      "type": "Action.OpenUrl",
      "title": "üîó View Alert 1",
      "url": "@{if(greater(length(split(triggerBody()?['text'], 'Source: ')), 1), split(triggerBody()?['text'], 'Source: ')[1], 'https://example.com')}"
    },
    {
      "type": "Action.OpenUrl",
      "title": "üîó View Alert 2",
      "url": "@{if(greater(length(split(triggerBody()?['text'], 'Source: ')), 2), split(triggerBody()?['text'], 'Source: ')[2], 'https://example.com')}"
    },
    {
      "type": "Action.OpenUrl",
      "title": "üîó View Alert 3",
      "url": "@{if(greater(length(split(triggerBody()?['text'], 'Source: ')), 3), split(triggerBody()?['text'], 'Source: ')[3], 'https://example.com')}"
    },
    {
      "type": "Action.OpenUrl",
      "title": "üîó View Alert 4",
      "url": "@{if(greater(length(split(triggerBody()?['text'], 'Source: ')), 4), split(triggerBody()?['text'], 'Source: ')[4], 'https://example.com')}"
    }
  ]
}







----------------------------------------



{
  "$schema": "http://adaptivecards.io/schemas/adaptive-card.json",
  "type": "AdaptiveCard",
  "version": "1.4",
  "body": [
    {
      // Dynamic Title with Severity Emoji
      "type": "TextBlock",
      "text": "@{if(contains(triggerBody()?['title'], 'FIRING'), if(contains(triggerBody()?['title'], 'critical'), 'üî•', if(contains(triggerBody()?['title'], 'warning'), '‚ö†Ô∏è', 'üí°')), '')} @{triggerBody()?['title']}",
      "weight": "Bolder",
      "size": "Large",
      "color": "@{if(contains(triggerBody()?['title'], 'FIRING'), 'Attention', if(contains(triggerBody()?['title'], 'RESOLVED'), 'Good', 'Default'))}",
      "wrap": true
    },
    {
      "type": "TextBlock",
      "text": "üö® **Alerts Summary**",
      "wrap": true,
      "weight": "Bolder",
      "size": "Medium",
      "spacing": "Medium",
      "separator": true
    },
    {
      "type": "TextBlock",
      "text": "Alerts Firing:",
      "wrap": true,
      "weight": "Bolder",
      "size": "Small",
      "spacing": "Default"
    },
    {
      "type": "TextBlock",
      "text": "üîπ **Labels:**",
      "wrap": true,
      "weight": "Bolder",
      "size": "Small",
      "spacing": "Medium"
    },
    {
      // Attempting to parse Labels into a FactSet - VERY BRITTLE
      "type": "FactSet",
      "facts": [
        {
          "title": "alertname:",
          "value": "@{
            split(
              split(triggerBody()?['text'], 'alertname = ')[1],
              '\n'
            )[0]
          }"
        },
        {
          "title": "alertgroup:",
          "value": "@{
            split(
              split(triggerBody()?['text'], 'alertgroup = ')[1],
              '\n'
            )[0]
          }"
        },
        {
          "title": "channel:",
          "value": "@{
            split(
              split(triggerBody()?['text'], 'channel = ')[1],
              '\n'
            )[0]
          }"
        },
        {
          "title": "namespace:",
          "value": "@{
            split(
              split(triggerBody()?['text'], 'namespace = ')[1],
              '\n'
            )[0]
          }"
        },
        {
          "title": "pod:",
          "value": "@{
            split(
              split(triggerBody()?['text'], 'pod = ')[1],
              '\n'
            )[0]
          }"
        },
        {
          "title": "severity:",
          "value": "@{
            split(
              split(triggerBody()?['text'], 'severity = ')[1],
              '\n'
            )[0]
          }"
        },
        {
          "title": "team:",
          "value": "@{
            split(
              split(triggerBody()?['text'], 'team = ')[1],
              '\n'
            )[0]
          }"
        }
      ]
    },
    {
      "type": "TextBlock",
      "text": "üìù **Annotations:**",
      "wrap": true,
      "weight": "Bolder",
      "size": "Small",
      "spacing": "Medium"
    },
    {
      // Attempting to parse Annotations into a FactSet - VERY BRITTLE
      "type": "FactSet",
      "facts": [
        {
          "title": "description:",
          "value": "@{
            split(
              split(triggerBody()?['text'], 'description = ')[1],
              '\n'
            )[0]
          }"
        },
        {
          "title": "summary:",
          "value": "@{
            split(
              split(triggerBody()?['text'], 'summary = ')[1],
              '\n'
            )[0]
          }"
        }
        // dashboard_url and runbook_url are pulled out for dedicated buttons
      ]
    },
    {
      "type": "TextBlock",
      "text": "üîó **Source:** @{if(greater(length(split(triggerBody()?['text'], 'Source: ')), 1), split(triggerBody()?['text'], 'Source: ')[1], 'N/A')}",
      "wrap": true,
      "spacing": "Medium"
    }
  ],
  "actions": [
    {
      "type": "Action.OpenUrl",
      "title": "üìä View Dashboard",
      "url": "@{
        if(contains(triggerBody()?['text'], 'dashboard_url = '),
           split(split(triggerBody()?['text'], 'dashboard_url = ')[1], '\n')[0],
           'https://example.com' // Fallback
        )
      }"
    },
    {
      "type": "Action.OpenUrl",
      "title": "üìñ View Runbook",
      "url": "@{
        if(contains(triggerBody()?['text'], 'runbook_url = '),
           split(split(triggerBody()?['text'], 'runbook_url = ')[1], '\n')[0],
           'https://example.com' // Fallback
        )
      }"
    }
  ]
}


------------------------------------------

{
  "$schema": "http://adaptivecards.io/schemas/adaptive-card.json",
  "type": "AdaptiveCard",
  "version": "1.4",
  "body": [
    {
      // Dynamic Title with Severity Emoji and Color
      "type": "TextBlock",
      "text": "@{if(contains(triggerBody()?['title'], 'FIRING'), if(contains(triggerBody()?['title'], 'critical'), 'üî•', if(contains(triggerBody()?['title'], 'warning'), '‚ö†Ô∏è', 'üí°')), '')} @{triggerBody()?['title']}",
      "weight": "Bolder",
      "size": "Large",
      "color": "@{if(contains(triggerBody()?['title'], 'FIRING'), 'Attention', if(contains(triggerBody()?['title'], 'RESOLVED'), 'Good', 'Default'))}",
      "wrap": true
    },
    {
      "type": "TextBlock",
      "text": "üö® **Alerts Summary**",
      "wrap": true,
      "weight": "Bolder",
      "size": "Medium",
      "spacing": "Medium",
      "separator": true
    },
    {
      "type": "TextBlock",
      "text": "Alerts Firing:", // As seen in your Slack screenshot
      "wrap": true,
      "weight": "Bolder",
      "size": "Small",
      "spacing": "Default"
    },
    {
      // This TextBlock will display the full parsed text from triggerBody()['text']
      // with improved formatting using replace functions.
      "type": "TextBlock",
      "text": "@{replace(replace(replace(triggerBody()?['text'], '\nLabels:', '\n\nüîπ **Labels:**\n'), '\nAnnotations:', '\n\nüìù **Annotations:**\n'), '\nSource:', '\n\nüîó **Source:** ')}",
      "wrap": true,
      "spacing": "Medium"
    }
  ],
  "actions": [
    {
      // Button for Dashboard URL
      "type": "Action.OpenUrl",
      "title": "üìä View Dashboard",
      "url": "@{
        if(contains(triggerBody()?['text'], 'dashboard_url = '),
           split(split(triggerBody()?['text'], 'dashboard_url = ')[1], '\n')[0],
           'https://example.com' // Fallback URL if not found
        )
      }"
    },
    {
      // Button for Runbook URL
      "type": "Action.OpenUrl",
      "title": "üìñ View Runbook",
      "url": "@{
        if(contains(triggerBody()?['text'], 'runbook_url = '),
           split(split(triggerBody()?['text'], 'runbook_url = ')[1], '\n')[0],
           'https://example.com' // Fallback URL if not found
        )
      }"
    },
    {
      // General "View Alert" button, fallback if specific URLs aren't found or as an extra option
      // This will use the "Source:" URL if present
      "type": "Action.OpenUrl",
      "title": "üîó View All Details",
      "url": "@{if(greater(length(split(triggerBody()?['text'], 'Source: ')), 1), split(triggerBody()?['text'], 'Source: ')[1], 'https://example.com')}"
    }
  ]
}



--------------------------------------------------

{
  "$schema": "http://adaptivecards.io/schemas/adaptive-card.json",

  "type": "AdaptiveCard",

  "version": "1.4",

  "body": [

    {
      "type": "TextBlock",
      "text": "@{triggerBody()?['title']}",
      "weight": "Bolder",
      "size": "Large",
      "color": "@{if(contains(triggerBody()?['title'], 'FIRING'), 'attention', if(contains(triggerBody()?['title'], 'RESOLVED'), 'good', 'default'))}",
      "wrap": true
    },

    {
      "type": "TextBlock",
      "text": "üö® **Alerts Summary**",
      "wrap": true,
      "weight": "Bolder",
      "size": "Medium",
      "spacing": "Medium",
      "separator": true
    },

    {
      "type": "TextBlock",
      "text": "@{replace(replace(replace(triggerBody()?['text'], '\nLabels:', '\n\nüîπ **Labels:**\n'), '\nAnnotations:', '\n\nüìù **Annotations:**\n'), '\nSource:', '\n\nüîó **Source:** ')}",
      "wrap": true,
      "spacing": "Medium"
    },

    {
      "type": "TextBlock",
      "text": "üìÖ **Date:** @{formatDateTime(triggerBody()?['date'], 'yyyy-MM-dd')}",
      "wrap": true,
      "spacing": "Medium"
    }

  ],

  "actions": [

    {
      "type": "Action.OpenUrl",
      "title": "üîó View Alert 1",
      "url": "@{if(greater(length(split(triggerBody()?['text'], 'Source: ')), 1), split(triggerBody()?['text'], 'Source: ')[1], 'https://example.com')}"
    },

    {
      "type": "Action.OpenUrl",
      "title": "üîó View Alert 2",
      "url": "@{if(greater(length(split(triggerBody()?['text'], 'Source: ')), 2), split(triggerBody()?['text'], 'Source: ')[2], 'https://example.com')}"
    },

    {
      "type": "Action.OpenUrl",
      "title": "üîó View Alert 3",
      "url": "@{if(greater(length(split(triggerBody()?['text'], 'Source: ')), 3), split(triggerBody()?['text'], 'Source: ')[3], 'https://example.com')}"
    },

    {
      "type": "Action.OpenUrl",
      "title": "üîó View Alert 4",
      "url": "@{if(greater(length(split(triggerBody()?['text'], 'Source: ')), 4), split(triggerBody()?['text'], 'Source: ')[4], 'https://example.com')}"
    }

  ]

}


